"use strict";(self.webpackChunkwhizardtelemetry_github_io=self.webpackChunkwhizardtelemetry_github_io||[]).push([[6117],{3536:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>o,contentTitle:()=>a,default:()=>l,frontMatter:()=>i,metadata:()=>c,toc:()=>h});var s=n(4848),t=n(8453);const i={sidebar_position:1},a="Whizard \u6027\u80fd\u6d4b\u8bd5\u8bf4\u660e",c={id:"advanced/benchmarks/benchmark",title:"Whizard \u6027\u80fd\u6d4b\u8bd5\u8bf4\u660e",description:"\u5bf9\u4e8e Whizard \u7684\u6027\u80fd\u6d4b\u8bd5\uff0c\u901a\u5e38\u53ef\u4ee5\u4ece\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\u5165\u624b\uff1a",source:"@site/whizard-docs/advanced/benchmarks/benchmark.md",sourceDirName:"advanced/benchmarks",slug:"/advanced/benchmarks/benchmark",permalink:"/zh-Hans/whizard-docs/advanced/benchmarks/benchmark",draft:!1,unlisted:!1,editUrl:"https://github.com/WhizardTelemetry/whizardtelemetry.github.io/tree/main/whizard-docs/whizard-docs/advanced/benchmarks/benchmark.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"\u57fa\u7ebf\u6d4b\u8bd5",permalink:"/zh-Hans/whizard-docs/category/\u57fa\u7ebf\u6d4b\u8bd5"},next:{title:"Whizard v0.6.0 \u6570\u636e\u8bfb\u5199\u6027\u80fd\u6d4b\u8bd5\u62a5\u544a",permalink:"/zh-Hans/whizard-docs/advanced/benchmarks/benchmark-v0.6.0"}},o={},h=[{value:"\u6027\u80fd\u6d4b\u8bd5\u5de5\u5177",id:"\u6027\u80fd\u6d4b\u8bd5\u5de5\u5177",level:2},{value:"\u6027\u80fd\u6d4b\u8bd5\u5173\u952e\u6307\u6807\u63cf\u8ff0",id:"\u6027\u80fd\u6d4b\u8bd5\u5173\u952e\u6307\u6807\u63cf\u8ff0",level:3},{value:"\u6027\u80fd\u6d4b\u8bd5\u62a5\u544a",id:"\u6027\u80fd\u6d4b\u8bd5\u62a5\u544a",level:3}];function d(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.h1,{id:"whizard-\u6027\u80fd\u6d4b\u8bd5\u8bf4\u660e",children:"Whizard \u6027\u80fd\u6d4b\u8bd5\u8bf4\u660e"}),"\n",(0,s.jsx)(r.p,{children:"\u5bf9\u4e8e Whizard \u7684\u6027\u80fd\u6d4b\u8bd5\uff0c\u901a\u5e38\u53ef\u4ee5\u4ece\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\u5165\u624b\uff1a"}),"\n",(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsx)(r.li,{children:"\u6570\u636e\u63a5\u6536\u6027\u80fd\uff1a\u6d4b\u8bd5 Whizard \u5728\u6570\u636e\u63a5\u53d7\u65b9\u9762\u7684\u6027\u80fd\u8868\u73b0\uff0c\u5305\u62ec\u6570\u636e\u6444\u5165\u901f\u5ea6\u3001\u6570\u636e\u5904\u7406\u65f6\u95f4\u3001\u6570\u636e\u5b58\u50a8\u6027\u80fd\u7b49\u65b9\u9762\u3002"}),"\n",(0,s.jsx)(r.li,{children:"\u6570\u636e\u67e5\u8be2\u6027\u80fd\uff1a\u6d4b\u8bd5 Whizard \u5728\u67e5\u8be2\u548c\u5206\u6790\u6570\u636e\u65b9\u9762\u7684\u6027\u80fd\u8868\u73b0\uff0c\u5305\u62ec\u67e5\u8be2\u54cd\u5e94\u65f6\u95f4\u3001\u67e5\u8be2\u541e\u5410\u91cf\u3001\u67e5\u8be2\u7ed3\u679c\u7684\u51c6\u786e\u6027\u7b49\u65b9\u9762\u3002"}),"\n",(0,s.jsx)(r.li,{children:"\u53ef\u6269\u5c55\u6027\u6d4b\u8bd5\uff1a\u6d4b\u8bd5 Whizard \u5728\u5904\u7406\u591a\u79df\u6237\u6570\u636e\u65f6\u7684\u6027\u80fd\u8868\u73b0\uff0c\u5305\u62ec\u6c34\u5e73\u6269\u5c55\u6027\u548c\u79df\u6237\u7ba1\u7406\u7b49\u65b9\u9762\u3002"}),"\n"]}),"\n",(0,s.jsx)(r.h2,{id:"\u6027\u80fd\u6d4b\u8bd5\u5de5\u5177",children:"\u6027\u80fd\u6d4b\u8bd5\u5de5\u5177"}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.a,{href:"https://github.com/frezes/prometheus-benchmark/tree/dev",children:"Prometheus-benchmark"})," allows testing data ingestion and querying performance for Prometheus-compatible systems on production-like workload."]}),"\n",(0,s.jsxs)(r.p,{children:["The prometheus-benchmark scrapes metrics from ",(0,s.jsx)(r.a,{href:"https://github.com/prometheus/node_exporter",children:"node_exporter"}),"\nand pushes the scraped metrics to the configured Prometheus-compatible remote storage systems.\nThese systems must support ",(0,s.jsx)(r.a,{href:"https://prometheus.io/docs/prometheus/latest/configuration/configuration/#remote_write",children:"Prometheus remote_write API"}),"\nfor measuring data ingestion performance. Optionally these systems may support\n",(0,s.jsx)(r.a,{href:"https://prometheus.io/docs/prometheus/latest/querying/api/#instant-queries",children:"Prometheus querying API"})," for measuring query performance."]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{alt:"prometheus-benchmark",src:n(6774).A+"",width:"1757",height:"1003"})}),"\n",(0,s.jsx)(r.p,{children:"The helm chart deploys the following pods:"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"vmagent"})," with the following containers:","\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.a,{href:"https://github.com/prometheus/node_exporter",children:"nodeexporter"})," - collects real metrics from Kubernetes node where it runs."]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.a,{href:"https://nginx.org/",children:"nginx"})," - caches responses from ",(0,s.jsx)(r.code,{children:"nodeexporter"})," for 1 second in order to reduce load on it\nwhen scraping big number of targets."]}),"\n",(0,s.jsx)(r.li,{children:"vmagent-config-updater - generates config for target scraping.\nIt is also responsible for generating time series churn rate via periodic updating of the generated targets."}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.a,{href:"https://docs.victoriametrics.com/vmagent.html",children:"vmagent"})," - scrapes ",(0,s.jsx)(r.code,{children:"nodeexporter"})," metrics via ",(0,s.jsx)(r.code,{children:"nginx"}),"\nfor targets generated by ",(0,s.jsx)(r.code,{children:"vmagent-config-updater"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"vmalert"})," with the following containers:","\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.a,{href:"https://docs.victoriametrics.com/vmalert.html",children:"vmalert"})," - periodically executes alerting rules\n(aka read queries) against the testes remote storage."]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.a,{href:"https://github.com/prometheus/alertmanager",children:"alertmanager"})," - receives notifications from ",(0,s.jsx)(r.code,{children:"vmalert"}),".\nIt is configured as a blackhole for the received notifications.\n",(0,s.jsx)(r.code,{children:"vmalert"})," pod is optional - it is used for generating read query load."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"vmsingle"})," - this pod runs a ",(0,s.jsx)(r.a,{href:"https://docs.victoriametrics.com/",children:"single-node VictoriaMetrics"}),", which collects metrics from ",(0,s.jsx)(r.code,{children:"vmagent"})," and ",(0,s.jsx)(r.code,{children:"vmalert"})," pods,\nso they could be analyzed during benchmark execution."]}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"\u6027\u80fd\u6d4b\u8bd5\u5173\u952e\u6307\u6807\u63cf\u8ff0",children:"\u6027\u80fd\u6d4b\u8bd5\u5173\u952e\u6307\u6807\u63cf\u8ff0"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"Data ingestion rate"}),"\n",(0,s.jsx)(r.li,{children:"99th percentile for the duration to execute queries"}),"\n",(0,s.jsx)(r.li,{children:"99th percentile for the duration to push the collected data to the configured remote storage systems"}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"\u6027\u80fd\u6d4b\u8bd5\u62a5\u544a",children:"\u6027\u80fd\u6d4b\u8bd5\u62a5\u544a"}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"\u5f53\u524d\u7248\u672c"}),"\uff1a"]}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"\u5386\u53f2\u7248\u672c:"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"/zh-Hans/whizard-docs/advanced/benchmarks/benchmark-v0.6.0",children:"Whizard v0.6.0 \u6570\u636e\u8bfb\u5199\u6027\u80fd\u6d4b\u8bd5\u62a5\u544a"})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"/zh-Hans/whizard-docs/advanced/benchmarks/benchmark-v0.5.0",children:"Whizard v0.5.0 \u6570\u636e\u8bfb\u5199\u6027\u80fd\u6d4b\u8bd5\u62a5\u544a"})}),"\n"]})]})}function l(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},6774:(e,r,n)=>{n.d(r,{A:()=>s});const s=n.p+"assets/images/prometheus-benchmark-architecture.excalidraw-bdec626591c4a2f2ab40c9e74f265403.png"},8453:(e,r,n)=>{n.d(r,{R:()=>a,x:()=>c});var s=n(6540);const t={},i=s.createContext(t);function a(e){const r=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),s.createElement(i.Provider,{value:r},e.children)}}}]);